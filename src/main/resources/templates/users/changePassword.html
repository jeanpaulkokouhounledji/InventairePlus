<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>Conventionnement | users management</title>
    <span layout:fragment="permalink"> Modification du mot de passe</span>
</head>

<body class="left-sidebar-fixed" ng-app="conventionApp" ng-controller="userController">
<section layout:fragment="costum-content">
    <!--main content wrapper-->
    <div class="container-fluid">

        <div class="row justify-content-center ">
            <div class="col-sm-6 p-2 text-center">
                <div class="card card-shadow mb-4">
                    <div class="card-header">
                        <div class="row justify-content-center"><h3 class="font-weight-bold">MON PROFIL</h3></div>
                        <div class="row justify-content-center"><i class="fa fa-user-circle-o fa-4x"></i></div>
                        <div class="row justify-content-center">
                            <a class="dropdown-item text-danger" th:href="@{/logout}">Déconnexion</a>
                        </div>
                    </div>
                    <div class="card-body">Nom d'utilisateur : <span class="text-danger font-weight-bold">{{userDetails.username}}</span></div>
                    <div>
                        <button class="btn btn-dark mb-4" ng-click="loadUser(userDetails.username);schowEditForm=true"> Modifier mon mot de passe </button>
                    </div>
                </div>
            </div>
        </div>
<!--        formulaire d'edition du mot de  passe -->
        <div class="row justify-content-center" ng-show="schowEditForm==true">
            <div class="col-sm-6">
                <div class="card card-shadow mb-4">
                    <div class="card-header border-0">
                        <div class="custom-title-wrap bar-warning">
                            <div class="custom-title">Modification du mot de passe !</div>
                        </div>
                    </div>
                    <div class="card-body">
                        <form class="form-horizontal" name="fnForm" enctype="multipart/form-data">
                            <div class="form-group-sm">
                                <label><span class="text-danger">*</span> Nom d'utilisateur</label>
                                <input type="text" ng-model="appUser.username"  name="username" title="Ce champs est reservé à la saisie du nom d'utilisateur" class="form-control form-control-sm mb-1" disabled required>
                            </div>
                            <div class="form-group-sm">
                                <label><span class="text-danger">*</span> Mot de passe</label>
                                <input type="password" ng-model="appUser.password" name="password" title="Mot de passe" class="form-control form-control-sm mb-1" required ng-pattern="pat">

                                <span ng-show="fnForm.password.$error.pattern" class="text-danger">
                                        Mot de passe non valide (Au moins : 9 caractères , 1 Majuscule(s), 1 caractère spécial dans @$!%*#_?& ).
                                    </span>

                            </div>
                            <div class="form-group-sm">
                                <label><span class="text-danger">*</span> Confirmez le mot de passe</label>
                                <input type="password" ng-model="repass"  title="Confirmez le mot de passe" class="form-control form-control-sm mb-1" required
                                       ng-keyup="compare(repass)" name="repass"
                                       ng-pattern="pat">
                                <span ng-show="repass!=''">
<!--                                        <span ng-show="isconfirm && fnForm.repass.$dirty">-->
                                        <small>Correspondance des mots de passe : <span ng-show="appUser.password==repass && appUser.password!=null" class="text-success"><i class="fa fa-check-circle-o text-success fa-2x"></i></span> <span ng-show="appUser.password!=repass"  class="text-danger"><i class="fa fa-times-circle-o text-danger fa-2x"></i></span></small>
                                    </span>
                            </div><br>
                            <form-row>
                                <button ng-click="saveUser();repass=null;schowEditForm=false" ng-disabled="appUser.password!=repass || appUser.password==null || repass==null " class="btn btn-sm btn-success mb-2 form-control" ><i class="fa fa-check fa-2x"></i> Valider </button>
                                <button ng-click="resetUserData();repass=null;schowEditForm=false" class="btn btn-sm btn-primary mb-2 form-control" type="button"><i class="fa fa-times fa-2x"></i> Annuler </button>
                            </form-row>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
</body>
</html>

